# lobby-data-system


# Setup
## Create organization

    https://supabase.com/dashboard/projects

1. Select "New Project"
2. Select desired organization
3. Enter project name "lobby-data-system", etc.
4. Enter database password and region
5. Select "Create new project"
## Install supabase cli

brew install supabase/tap/supabase

## Configure Supabase CLI / Local Project

# note: make sure to update supabase cli
```
brew upgrade supabase
```

```
supabase init

supabase login

supabase projects list
```

Link project and enter database password
```
supabase link --project-ref $PROJECT_ID
```

Pull existing migrations from supabase project
```
supabase db pull
```


# Updating Database
Make supabase is started locally
```
supabase start
```

Create a new migration file
```
supabase migration new <name>
```

Make changes in autogenerated file and then reset db. This will apply all migrations in the supabase/migrations folder

```
supabase db reset
```

## Generating types (Not used currently)
```
supabase gen types typescript --local > supabase/types/supabase.ts
```

## Running Functions Locally
```
supabase functions serve --debug
```

## Deploying Functions
```
supabase secrets set --env-file ./supabase/functions/.env
```

```
supabase functions deploy data-api
```

## Reset remote database (DEV ONLY!)

Always check linked project first:
```
supabase projects list
```

```
supabase db reset --linked
```

## Generate Documentation Diagrams

1. Install plantuml

```bash
brew install plantuml
```

2. Run the generation command
```bash
plantuml -overwrite ./docs/diagrams/main.puml
```